<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jonas Otto" />
  <meta name="dcterms.date" content="2023-01-01" />
  <title>Architectures for Distributed Internet Services</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="styling.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js"
  type="text/javascript"></script>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">Architectures for Distributed Internet Services</h1>
<p class="author">Jonas Otto</p>
<p class="date">2023</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#architectures-for-distributed-internet-services"
id="toc-architectures-for-distributed-internet-services">Architectures
for Distributed Internet Services</a></li>
<li><a href="#static-web-content" id="toc-static-web-content">Static Web
Content</a>
<ul>
<li><a href="#web-servers" id="toc-web-servers">Web Servers</a>
<ul>
<li><a href="#static-content" id="toc-static-content">Static
Content</a></li>
<li><a href="#architectures"
id="toc-architectures">Architectures</a></li>
</ul></li>
</ul></li>
<li><a href="#dynamic-web-content" id="toc-dynamic-web-content">Dynamic
Web Content</a>
<ul>
<li><a href="#client-side-dynamicity"
id="toc-client-side-dynamicity">Client-side dynamicity</a></li>
<li><a href="#server-side-dynamicity"
id="toc-server-side-dynamicity">Server-side dynamicity</a></li>
<li><a href="#creating-dynamic-web-content"
id="toc-creating-dynamic-web-content">Creating dynamic web content</a>
<ul>
<li><a href="#server-side-includes" id="toc-server-side-includes">Server
Side Includes</a></li>
<li><a href="#external-programs-cgi"
id="toc-external-programs-cgi">External Programs: CGI</a></li>
<li><a href="#alternative-fastcgi"
id="toc-alternative-fastcgi">Alternative: FastCGI</a></li>
<li><a
href="#scgi-simple-common-gateway-interface-alternative-to-fastcgi"
id="toc-scgi-simple-common-gateway-interface-alternative-to-fastcgi">SCGI
(Simple Common Gateway Interface): Alternative to FastCGI</a></li>
<li><a href="#problems-with-cgi" id="toc-problems-with-cgi">Problems
with CGI</a></li>
</ul></li>
</ul></li>
<li><a href="#server-side-scripting"
id="toc-server-side-scripting">Server-side Scripting</a>
<ul>
<li><a href="#example-perl" id="toc-example-perl">Example: Perl</a></li>
<li><a href="#example-java" id="toc-example-java">Example: Java</a></li>
<li><a href="#example-php" id="toc-example-php">Example: PHP</a></li>
</ul></li>
<li><a href="#data-management-sever-side-state"
id="toc-data-management-sever-side-state">Data Management: Sever-Side
State</a>
<ul>
<li><a href="#storage-options" id="toc-storage-options">Storage
Options</a>
<ul>
<li><a href="#main-memory" id="toc-main-memory">main memory</a></li>
<li><a href="#local-storage" id="toc-local-storage">local
storage</a></li>
<li><a href="#remote-storage" id="toc-remote-storage">remote
storage</a></li>
</ul></li>
</ul></li>
<li><a href="#session-management" id="toc-session-management">Session
Management</a>
<ul>
<li><a href="#url-session-identifiers"
id="toc-url-session-identifiers">URL Session Identifiers</a></li>
<li><a href="#cookies" id="toc-cookies">Cookies</a></li>
<li><a href="#session-state" id="toc-session-state">Session
State</a></li>
<li><a href="#securtity" id="toc-securtity">Securtity</a></li>
</ul></li>
<li><a href="#client-side-developments"
id="toc-client-side-developments">Client-side Developments</a></li>
<li><a href="#object-relational-mapping"
id="toc-object-relational-mapping">Object-Relational Mapping</a></li>
<li><a href="#structured-developments"
id="toc-structured-developments">Structured Developments</a>
<ul>
<li><a href="#mvc" id="toc-mvc">MVC</a>
<ul>
<li><a href="#summary" id="toc-summary">Summary</a></li>
</ul></li>
<li><a href="#some-more-structural-patterns"
id="toc-some-more-structural-patterns">Some more structural patterns</a>
<ul>
<li><a href="#inversion-of-control-ioc"
id="toc-inversion-of-control-ioc">Inversion of Control (IoC)</a></li>
<li><a href="#dont-repeat-yourself" id="toc-dont-repeat-yourself">Don’t
Repeat Yourself</a></li>
<li><a href="#convention-over-configuration"
id="toc-convention-over-configuration">Convention Over
Configuration</a></li>
<li><a href="#structured-project-directories"
id="toc-structured-project-directories">Structured Project
Directories</a></li>
</ul></li>
</ul></li>
<li><a href="#ria-and-spa" id="toc-ria-and-spa">RIA and SPA</a>
<ul>
<li><a href="#thin-vs.-thick-clients"
id="toc-thin-vs.-thick-clients">Thin vs. Thick Clients</a></li>
<li><a href="#rich-internet-applications-ria"
id="toc-rich-internet-applications-ria">Rich Internet Applications
(RIA)</a></li>
<li><a href="#single-page-applications-spa"
id="toc-single-page-applications-spa">Single Page Applications
(SPA)</a></li>
</ul></li>
<li><a href="#node.js-and-unification-of-languages"
id="toc-node.js-and-unification-of-languages">Node.js and Unification of
Languages</a>
<ul>
<li><a href="#emerging-challenges" id="toc-emerging-challenges">Emerging
Challenges</a></li>
<li><a href="#event-driven-web-application-runtime"
id="toc-event-driven-web-application-runtime">Event-driven Web
Application Runtime</a></li>
<li><a href="#node.js" id="toc-node.js">Node.js</a></li>
<li><a href="#unification-of-languages"
id="toc-unification-of-languages">Unification of Languages</a></li>
</ul></li>
<li><a href="#component-based-frameworks"
id="toc-component-based-frameworks">Component-based Frameworks</a>
<ul>
<li><a href="#web-components-specification"
id="toc-web-components-specification">Web Components
Specification</a></li>
<li><a href="#component-based-application-frameworks"
id="toc-component-based-application-frameworks">Component-based
Application Frameworks</a></li>
</ul></li>
<li><a href="#progressive-web-applications"
id="toc-progressive-web-applications">Progressive Web
Applications</a></li>
<li><a href="#popular-implementations"
id="toc-popular-implementations">Popular Implementations</a></li>
<li><a href="#introduction-to-scalability"
id="toc-introduction-to-scalability">Introduction to Scalability</a>
<ul>
<li><a href="#part-1" id="toc-part-1">Part 1</a>
<ul>
<li><a href="#client-side-performance-metrics"
id="toc-client-side-performance-metrics">Client Side Performance
Metrics</a></li>
<li><a href="#server-side-performance-metrics"
id="toc-server-side-performance-metrics">Server Side Performance
Metrics</a></li>
</ul></li>
<li><a href="#part-2" id="toc-part-2">Part 2</a>
<ul>
<li><a href="#load-characteristics" id="toc-load-characteristics">Load
Characteristics</a></li>
<li><a href="#scalability-strategies"
id="toc-scalability-strategies">Scalability Strategies</a></li>
</ul></li>
</ul></li>
<li><a href="#interactioncommunication"
id="toc-interactioncommunication">Interaction/Communication</a>
<ul>
<li><a href="#http2" id="toc-http2">HTTP2</a></li>
<li><a href="#client-backend-communication"
id="toc-client-backend-communication">Client-Backend Communication</a>
<ul>
<li><a href="#rest" id="toc-rest">REST</a></li>
<li><a href="#graphql" id="toc-graphql">GraphQL</a></li>
<li><a href="#websockets" id="toc-websockets">Websockets</a></li>
</ul></li>
<li><a href="#backend-backend-communication"
id="toc-backend-backend-communication">Backend-Backend Communication</a>
<ul>
<li><a href="#rpc-remote-procedure-call"
id="toc-rpc-remote-procedure-call">RPC: Remote Procedure Call</a></li>
<li><a href="#web-services-communication"
id="toc-web-services-communication">Web Services Communication</a></li>
</ul></li>
<li><a href="#advanced-concepts" id="toc-advanced-concepts">Advanced
Concepts</a>
<ul>
<li><a href="#messaging" id="toc-messaging">Messaging</a></li>
<li><a href="#seda-staged-event-driven-architecture"
id="toc-seda-staged-event-driven-architecture">SEDA: Staged Event-Driven
Architecture</a></li>
<li><a href="#back-pressure" id="toc-back-pressure">Back
Pressure</a></li>
</ul></li>
</ul></li>
<li><a href="#state" id="toc-state">State</a>
<ul>
<li><a href="#state-in-scalable-web-architectures"
id="toc-state-in-scalable-web-architectures">State in Scalable Web
Architectures</a></li>
<li><a href="#caching" id="toc-caching">Caching</a></li>
<li><a href="#data-models" id="toc-data-models">Data Models</a>
<ul>
<li><a href="#relational-model" id="toc-relational-model">Relational
Model</a></li>
<li><a href="#keyvalue" id="toc-keyvalue">Key/Value</a></li>
<li><a href="#document-oriented" id="toc-document-oriented">Document
oriented</a></li>
<li><a href="#graph-model" id="toc-graph-model">Graph Model</a></li>
<li><a href="#column-oriented-model"
id="toc-column-oriented-model">Column-oriented Model</a></li>
</ul></li>
<li><a href="#functional-decomposition"
id="toc-functional-decomposition">Functional Decomposition</a></li>
<li><a href="#replication" id="toc-replication">Replication</a>
<ul>
<li><a href="#leader-follower-replication"
id="toc-leader-follower-replication">Leader-Follower
Replication</a></li>
<li><a href="#multi-leader-replication"
id="toc-multi-leader-replication">Multi-Leader Replication</a></li>
<li><a href="#leaderless-replication"
id="toc-leaderless-replication">Leaderless Replication</a></li>
</ul></li>
<li><a href="#shardingpartitioning"
id="toc-shardingpartitioning">Sharding/Partitioning</a></li>
<li><a href="#data-consistency" id="toc-data-consistency">Data
Consistency</a>
<ul>
<li><a href="#cap-theorem" id="toc-cap-theorem">CAP Theorem</a></li>
<li><a href="#pacelc-theorem" id="toc-pacelc-theorem">PACELC
Theorem</a></li>
<li><a href="#harvestyield" id="toc-harvestyield">Harvest/Yield</a></li>
</ul></li>
<li><a href="#event-sourcing" id="toc-event-sourcing">Event
Sourcing</a></li>
</ul></li>
<li><a href="#logic" id="toc-logic">Logic</a>
<ul>
<li><a href="#application-logic" id="toc-application-logic">Application
Logic</a></li>
<li><a href="#stateless-and-stateful-application-logic"
id="toc-stateless-and-stateful-application-logic">Stateless and Stateful
Application Logic</a></li>
<li><a href="#distributing-application-logic"
id="toc-distributing-application-logic">Distributing Application
Logic</a>
<ul>
<li><a href="#functional-partitioning"
id="toc-functional-partitioning">Functional Partitioning</a></li>
<li><a href="#horizontal-duplication-replication"
id="toc-horizontal-duplication-replication">Horizontal Duplication
(Replication)</a></li>
<li><a href="#data-partitioning-sharding"
id="toc-data-partitioning-sharding">Data Partitioning
(Sharding)</a></li>
<li><a href="#shared-and-global-state"
id="toc-shared-and-global-state">Shared and Global State</a></li>
</ul></li>
<li><a href="#background-tasks" id="toc-background-tasks">Background
Tasks</a>
<ul>
<li><a href="#batch-processing" id="toc-batch-processing">Batch
Processing</a></li>
<li><a href="#stream-processing" id="toc-stream-processing">Stream
Processing</a></li>
</ul></li>
<li><a href="#event-sourcing-and-cqrs"
id="toc-event-sourcing-and-cqrs">Event Sourcing and CQRS</a></li>
</ul></li>
<li><a href="#deploymentinfrastructure"
id="toc-deploymentinfrastructure">Deployment/Infrastructure</a>
<ul>
<li><a href="#backend-endpoints" id="toc-backend-endpoints">Backend
Endpoints</a>
<ul>
<li><a href="#proxies" id="toc-proxies">Proxies</a></li>
<li><a href="#load-balancing" id="toc-load-balancing">Load
Balancing</a></li>
<li><a href="#cdns" id="toc-cdns">CDNs</a></li>
</ul></li>
<li><a href="#cloud-computing" id="toc-cloud-computing">Cloud
Computing</a>
<ul>
<li><a href="#service-models" id="toc-service-models">Service
Models</a></li>
<li><a href="#virtualization"
id="toc-virtualization">Virtualization</a></li>
</ul></li>
<li><a href="#advanced-topics" id="toc-advanced-topics">Advanced
Topics</a></li>
</ul></li>
<li><a href="#security-and-privacy"
id="toc-security-and-privacy">Security and Privacy</a></li>
<li><a href="#devops" id="toc-devops">DevOps</a></li>
</ul>
</nav>
<h1 id="architectures-for-distributed-internet-services">Architectures
for Distributed Internet Services</h1>
<p>This is my summary for the lecture “Architectures for Distributed
Internet Services”, as held by Franz Hauck and Benjamin Erb in 2022 at
Ulm University.</p>
<p>The HTML version of this summary can be found at <a
href="https://ottojo.github.io/ADIS_Summary/">https://ottojo.github.io/ADIS_Summary/</a>,
the sources are on GitHub at <a
href="https://github.com/ottojo/ADIS_Summary">https://github.com/ottojo/ADIS_Summary</a>.</p>
<h1 id="static-web-content">Static Web Content</h1>
<h2 id="web-servers">Web Servers</h2>
<ul>
<li>HTTP endpoint which exposes HTTP endpoints</li>
<li>Typical tasks:
<ul>
<li>Request parsing</li>
<li>URI resolving</li>
<li>Responding with appropriate content</li>
</ul></li>
<li>Content often provided by external components</li>
<li>Offers SSL/TLS termination</li>
<li>Might provide access control</li>
<li>Might provide caching</li>
</ul>
<h3 id="static-content">Static Content</h3>
<ul>
<li>This represents a large amount of web resources</li>
<li>Examples:
<ul>
<li>Immutable content (images, videos, static pages)</li>
<li>Static assets (stylesheets, JS sources)</li>
</ul></li>
<li>Server performance in this case predominantly I/O-bound (both disk
and network)</li>
</ul>
<h3 id="architectures">Architectures</h3>
<h4 id="multi-thread-multi-process">multi-thread / multi-process</h4>
<ul>
<li>One dedicated thread for accepting connections</li>
<li>Dedicated thread per connections (spawned by first thread)</li>
<li>Allows multiple concurrent connections</li>
<li>Synchronous, blocking IO may be used</li>
<li>Large number of connections make efficient scheduling
challenging</li>
<li>-&gt; C10k Problem: Challenge of handling 10k concurrent connections
to a server (early 2000s, now: C1M scale and beyond)</li>
</ul>
<h4 id="solutions-for-the-c10k-problem">Solutions for the C10k
Problem</h4>
<ul>
<li>Avoid spawning many processes</li>
<li>Avoid 1:1 mapping between connections and threads</li>
<li>Using asynchronous and non-blocking I/O (reduces number of waiting
threads)</li>
</ul>
<h4 id="reactor-pattern">Reactor Pattern</h4>
<ul>
<li>Reactor: single thread with event-loop
<ul>
<li>reacts to IO events from a queue</li>
<li>dispatches events</li>
</ul></li>
<li>Event-specific handlers
<ul>
<li>process events produced by reactor</li>
</ul></li>
<li>Implemented in nginx: One master process + one worker per core</li>
</ul>
<h1 id="dynamic-web-content">Dynamic Web Content</h1>
<h2 id="client-side-dynamicity">Client-side dynamicity</h2>
<ul>
<li>Generated within browser</li>
<li>Related to presentation of content</li>
</ul>
<h2 id="server-side-dynamicity">Server-side dynamicity</h2>
<ul>
<li>automatic updating of static files</li>
<li>webserver delegates requests to external programs
<ul>
<li>e.g. CGI script</li>
</ul></li>
<li>webserver executes scripts internally
<ul>
<li>e.g. php module</li>
</ul></li>
<li>webserver has builtin site-gerneration code
<ul>
<li>tight coupling between webserver and application</li>
</ul></li>
</ul>
<h2 id="creating-dynamic-web-content">Creating dynamic web content</h2>
<ul>
<li>some program takes http requests as input and produces web resources
(HTML) as output
<ul>
<li>e.g. java servelet</li>
</ul></li>
<li>code may be embedded into web resource, inserting code output into
resource
<ul>
<li>e.g. java server faces, PHP</li>
</ul></li>
</ul>
<h3 id="server-side-includes">Server Side Includes</h3>
<ul>
<li>Directives inserted into HTML</li>
<li>executed by the server, but may delegate to CGI scripts</li>
</ul>
<h3 id="external-programs-cgi">External Programs: CGI</h3>
<ul>
<li>Specifies interaction between webserver and external programs (CGI
scripts)</li>
<li>Server spawns new process for each request</li>
<li>HTTP headers passed via env variables</li>
<li>HTTP body passed via stdin</li>
<li>CGI script may produce entire HTTP response, or only essential
headers and body (remaining data added by server)</li>
<li>Modules for interacting with CGI webserver exist in programming
languages, such as CGI.pm in perl</li>
</ul>
<p>Drawbacks:</p>
<ul>
<li>Process creation may be slow</li>
<li>Script initialization happens on every request</li>
<li>Limited communication channel in stdin/out</li>
</ul>
<h3 id="alternative-fastcgi">Alternative: FastCGI</h3>
<ul>
<li>Binary protocol</li>
<li>via unix socket/named pipe/tcp connection</li>
<li>Script keeps running and processes multiple request</li>
<li>Multiple (remote) FastCGI applications may be running and accessed
by single web server
<ul>
<li>allows load balancing</li>
<li>separates web and application server</li>
</ul></li>
</ul>
<h3
id="scgi-simple-common-gateway-interface-alternative-to-fastcgi">SCGI
(Simple Common Gateway Interface): Alternative to FastCGI</h3>
<ul>
<li>Simplifies interface: non-binary interface</li>
<li>Easier to implement than FastCGI</li>
</ul>
<h3 id="problems-with-cgi">Problems with CGI</h3>
<ul>
<li>CGI programs often use same security context as web server</li>
<li>Apache allows running CGI scripts as specified user/group</li>
</ul>
<h1 id="server-side-scripting">Server-side Scripting</h1>
<p>Scenario: Static HTML page should be enriched by dynamic content.</p>
<p>Here, inside-out scripting is considered. This means scripts are
placed inside HTML document. The script output is inserted at their
location in the HTML document.</p>
<p>Execution of the scripts:</p>
<ul>
<li>External script interpreter, spawned by server</li>
<li>Long-ruinning external execution environment
<ul>
<li>Similar benefits to FastCGI vs CGI</li>
<li>Used by PHP for example</li>
</ul></li>
<li>Server-internal script handling</li>
</ul>
<p>Inside-out scripting allows HTML-centric development approach.</p>
<p>Self-processing pages are a pattern for processing form data on the
same page it is displayed on. This is done by distinguishing between
GET/POST request during script execution.</p>
<h2 id="example-perl">Example: Perl</h2>
<ul>
<li>Approach 1
<ul>
<li>HTML provided in template file with placeholders</li>
<li>Separate script provides content for placeholders</li>
</ul></li>
<li>Approach 2
<ul>
<li>Code directly embedded in HTML with special syntax</li>
<li>Output is inserted in location of script, if requested</li>
</ul></li>
</ul>
<h2 id="example-java">Example: Java</h2>
<ul>
<li>Inside-out scripting approach</li>
<li>Before execution, JSP-to-Java transformation transforms HTML with
embedded scripts to Java program (“Servlet”) which outputs entire page,
containing static and dynamic content.</li>
<li>Generated Servlet allows ahead-of-time compilation</li>
</ul>
<h2 id="example-php">Example: PHP</h2>
<ul>
<li>Designed for inside-out scripting</li>
<li>Execution environment included in web servers like apache</li>
<li>Includes useful functionality for web-dev (databases, HTTP,
etc)</li>
</ul>
<h1 id="data-management-sever-side-state">Data Management: Sever-Side
State</h1>
<p>Data is stored both on server and client, and data is exchanged in
requests and responses. Examples for client data include:</p>
<ul>
<li>Cached resources</li>
<li>Cookies</li>
<li>JS engine state</li>
</ul>
<p>Server data includes:</p>
<ul>
<li>Application data</li>
<li>Session state</li>
<li>Application state</li>
</ul>
<p>The server holds <em>static</em> resources and <em>dynamic</em>
application state. Application state may include:</p>
<ul>
<li>User accounts and preferences</li>
<li>Dynamically generated content
<ul>
<li>recommendations</li>
<li>shopping cart</li>
<li>messages between users</li>
</ul></li>
<li>Cached and aggregated data</li>
</ul>
<p>Aspects of server-side state include:</p>
<ul>
<li>how to interact with the server state</li>
<li>how data is modeled</li>
<li>mutability of data</li>
<li>security</li>
<li>storage duration</li>
<li>access patterns</li>
</ul>
<p>Resulting from those aspects are design choices regarding server-side
state:</p>
<h2 id="storage-options">Storage Options</h2>
<p>Options are:</p>
<h3 id="main-memory">main memory</h3>
<ul>
<li>application state
<ul>
<li>program memory (stack + heap)</li>
<li>usually managed by language runtime</li>
</ul></li>
<li>in-memory databases
<ul>
<li>provide access API</li>
<li>may provide guarantees about integrity, consistency, visibility</li>
<li>examples: sqlite (in-memory version), h2, many more</li>
</ul></li>
<li>both easy to use and fast access time</li>
<li>drawbacks:
<ul>
<li>volatility (data loss on process stop/restart, overhead
otherwise)</li>
<li>small size</li>
</ul></li>
<li>popular for short lived data with fast access requirements</li>
</ul>
<h3 id="local-storage">local storage</h3>
<ul>
<li>file system (flat files)
<ul>
<li>advantages:
<ul>
<li>easy to use</li>
<li>well supported</li>
<li>persistent</li>
<li>easy to backup</li>
<li>large size</li>
</ul></li>
<li>disadvantages
<ul>
<li>unindexed</li>
<li>unstructures</li>
<li>no guarantees for concurrent writes etc</li>
</ul></li>
<li>popular for simple applications</li>
</ul></li>
<li>databases
<ul>
<li>advantages:
<ul>
<li>data is structured</li>
<li>indexed</li>
<li>allow complex search operations</li>
<li>allow relational data</li>
<li>large size</li>
<li>transaction support -&gt; consistency</li>
<li>usually allow distributed setups</li>
<li>integration with other services through standard interfaces
(SQL)</li>
</ul></li>
<li>drawbacks:
<ul>
<li>complex API</li>
<li>complex management and administration</li>
</ul></li>
<li>popular for complex structured application data
<ul>
<li>relational databases like postgresql, sqlite, mariadb</li>
<li>noSQL databases, such as k/v stores, document or graph
databases</li>
</ul></li>
</ul></li>
</ul>
<h3 id="remote-storage">remote storage</h3>
<ul>
<li>information systems like CRMs</li>
<li>external web services (database server, remote FS)</li>
</ul>
<h1 id="session-management">Session Management</h1>
<p>Sessions provide state beyond individual HTTP requests. Example uses
are multi-step forms, login status or shopping carts.</p>
<p>This requires the server to identify subsequent requests belonging to
the same user/session. A session is the list of consecutive actions of
an individual user. This is usually implemented by labeling the
requests, that label is called <em>Session ID</em> or <em>Session
Token</em>. The ID is generated on the server side, and has to be unique
and un-guessable (to prevent session hijacking). It is transmitted to
the client in the first response, which then includes it in subsequent
requests. This allows the server to relate it to the session.</p>
<p>Sessions may end, either explicitly (discarding the session ID on
server or client) or by timeout.</p>
<h2 id="url-session-identifiers">URL Session Identifiers</h2>
<p>Also called <em>URL rewriting</em>, this is a technique for handling
session IDs. It works by embedding the ID in the URL, which requires the
server to rewrite all hyperlinks in the response to include the ID.</p>
<p>Advantages:</p>
<ul>
<li>No client support needed</li>
<li>No additional headers required</li>
<li>No cookies required</li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>Security risk: Session ID easily exposed by sharing or logging an
URL</li>
<li>Correct rewriting might be difficult</li>
</ul>
<h2 id="cookies">Cookies</h2>
<p>Cookies are small chunks of data (KV pairs) related to one domain,
which the client includes for every request to the same domain. Cookies
provide a more secure way to attach IDs to session.</p>
<p>The server provides the cookies using <code>Set-Cookie</code>
headers, which include the session ID.</p>
<p>The client receives the cookie, saves it and sends it back to the
server in subsequent requests using the <code>Cookie</code> header.</p>
<h2 id="session-state">Session State</h2>
<p>Once the server has the possibility to relate requests to sessions,
session state can be stored. This session state can be arbitrary, and
would usually stored in a database indexed by the session ID.</p>
<p>In principle, the entire state could be stored in a cookie, which
eliminates the need for server-side storage but has several drawbacks
such as limited size and the possibility for the client to modify the
state in unexpected ways.</p>
<h2 id="securtity">Securtity</h2>
<p>There are multiple security considerations regarding sessions, in
particular Leaking the ID, which can lead to session hijacking and thus
impersonating the user</p>
<h1 id="client-side-developments">Client-side Developments</h1>
<p>The desire for more dynamic user interfaces in the web go beyond
static HTML pages delivered from the server, and interactions consisting
mainly of navigating to different pages. This requires computation on
the client-side, which is possible using javascript. Today, the
client-side of a web page consist of multiple elements of</p>
<ul>
<li>HTML, defining the content and structure of the page</li>
<li>CSS, providing styling and display information</li>
<li>JavaScript, providing interaction and defining the dynamic
behavior</li>
</ul>
<p>The JS execution model of a browser consists of an event loop
processing callbacks. Inside the callbacks, the JS code has access to
multiple APIs, such as for reading and modifying the DOM, setting timers
or making (AJAX) requests.</p>
<h1 id="object-relational-mapping">Object-Relational Mapping</h1>
<p>Traditionally, relational DBs are accessed using SQL statements.
Drawbacks to this are that SQL is both a different programming model to
the application language and a different data model (relational vs e.g.
variables, object oriented). This requires mapping between those two
domains, and to synchronously maintain both models, the application code
and database.</p>
<p>An idea to solve this is to specify the model only in the application
programming language. Data entities could be represented by language
objects, relationships by references between objects. The mapping to the
DB data model is automatic. Database queries/updates are hidden behind
read/write of an object or its properties. Database inserts are hidden
behind object creation. Executing queries instantiates language objects
(queries themselves still exist).</p>
<p>The database still requires a data model, and schema. This could
however automatically be generated from the data model definition in the
application language, and may even automatically synchronize changes in
the data model.</p>
<h1 id="structured-developments">Structured Developments</h1>
<p>All web developments covered up to this lecture required lots of
boilerplate code, which is error prone and causes a high development
overhead. This created a demand for a more structured development
environment, which includes:</p>
<ul>
<li>Structure and best practices</li>
<li>Common patterns for useful abstractions</li>
<li>Automation of common tasks</li>
</ul>
<p>Those demands ultimately resulted in entire new frameworks for web
development.</p>
<h2 id="mvc">MVC</h2>
<p>Model-View-Controller is an architectural pattern applied to
web-based services. It separates the application into three independent
components:</p>
<ul>
<li>Model
<ul>
<li>Represents data</li>
</ul></li>
<li>View
<ul>
<li>Obtains data from the model in some way</li>
<li>Presents data to the user</li>
</ul></li>
<li>Controller
<ul>
<li>Handles user interaction</li>
<li>Performs operation on data</li>
<li>Controls views, such as activating a new view</li>
</ul></li>
</ul>
<p>The business logic may be located in either the controller or model.
If the logic is combined with the data in the model, operations would
still be invoked by the controller.</p>
<p>MVC can be applied to web applications in multiple ways:</p>
<h4 id="server-side-mvc">Server Side MVC</h4>
<ul>
<li>All components contained in the server (e.g. CGI script)</li>
<li>Input request handled by controller</li>
<li>Response generated by view</li>
</ul>
<p>Technologies such as Java Servlets assist in extracting the model,
but controller and view would still be tightly coupled. Java Server
Faces provides a generic, configurable controller component and allow
separating the view (“Facelet”). The view can be implemented
declaratively as an HTML page containing references to the model.</p>
<p>Django takes a different approach: Django separates the tasks in the
components view, model and template. The view handles the request and
contains the business logic (like the controller in other examples). The
template corresponds to the view in the java example: It is an HTML
template which gets instantiated with model data by the view.</p>
<h3 id="summary">Summary</h3>
<ul>
<li>MVC allows modularization, and separates design from
programming</li>
<li>Frameworks reduce required boilerplate code by providing common
components</li>
<li>Templating for views simplify development</li>
<li>Modularization leads to improved testability</li>
</ul>
<h2 id="some-more-structural-patterns">Some more structural
patterns</h2>
<h3 id="inversion-of-control-ioc">Inversion of Control (IoC)</h3>
<p>This principle states that the application code is <em>reactive</em>,
not active: it gets called by the framework when relevant events occur,
instead of being the main entrypoint into the application.</p>
<h3 id="dont-repeat-yourself">Don’t Repeat Yourself</h3>
<p>Self explanatory</p>
<h3 id="convention-over-configuration">Convention Over
Configuration</h3>
<p>Code, configuration and other aspects such as directory structure
should be derived from convention whenever possible.</p>
<h3 id="structured-project-directories">Structured Project
Directories</h3>
<ul>
<li>Frameworks usually have conventions, an it’s useful to adhere to
them</li>
<li>Frameworks sometimes provide generation of project scaffolding
(Django, Ruby on Rails)</li>
</ul>
<h1 id="ria-and-spa">RIA and SPA</h1>
<h2 id="thin-vs.-thick-clients">Thin vs. Thick Clients</h2>
<p>In thin-client applications, the browser only handles inputs and
renders responses from the server. Interactions between client and
server are HTTP requests.</p>
<p>Thick-client applications move some business logic to the client
side. This typically allows for improvements in user experience. Some
actions are executed locally without server interaction. Other
interactions with the server might be application specific, once the
client application is loaded.</p>
<h2 id="rich-internet-applications-ria">Rich Internet Applications
(RIA)</h2>
<p>Basic idea: Resemble user experience of local desktop application.
This requires running some logic on the client side. An extreme example
would be a client side game engine running in the browser. RIAs allow
platform independence, which might be an advantage compared to native
applications.</p>
<p>Examples of RIAs:</p>
<ul>
<li>Google Docs</li>
<li>Web mail clients</li>
<li>Flash games</li>
</ul>
<p>Frameworks are available for both client- and server-side
programming.</p>
<p>Today, RIA are “rich web applications”, using native web technologies
such as HTML(5), CSS and JS.</p>
<h2 id="single-page-applications-spa">Single Page Applications
(SPA)</h2>
<p>SPAs are thick clients, using current web technologies (HTML5, CSS3)
and modern web APIs using JS. The page is loaded only once, and the
application dynamically modifies the current page based on user input,
instead of loading new pages. Interaction with the server is done in the
background.</p>
<p>Technologies used:</p>
<ul>
<li>Communication
<ul>
<li>Regular HTTP request for initial load</li>
<li>AJAX/fetch, server-push or WS for later communication</li>
</ul></li>
<li>Data formats
<ul>
<li>JSON and XML for structured data</li>
<li>Alternative: pre-generated HTML from the server</li>
</ul></li>
</ul>
<p>Challenges include:</p>
<ul>
<li>Slow initial loading time</li>
<li>Programmatic access e.g. for search engines</li>
<li>Handling of application state vs page location</li>
<li>Partitioning of logic between client and server</li>
</ul>
<h1 id="node.js-and-unification-of-languages">Node.js and Unification of
Languages</h1>
<h2 id="emerging-challenges">Emerging Challenges</h2>
<ul>
<li>Scalability: C10k-like problems for dynamic content</li>
<li>Coordination between server and client, with many clients</li>
<li>Interaction between concurrent requests</li>
<li>Near-real-time information distribution</li>
</ul>
<p>A traditional web application usually features</p>
<ul>
<li>Isolation of individual requests at the server</li>
<li>Application state exclusively in database</li>
</ul>
<p>while a modern application wants to use techniques such as long
polling, wherein the server delays a response until some event has
occurred (such as a new chat message being sent). This requires a new
programming model with</p>
<ul>
<li>Explicit concurrency support (inter-request interactions)</li>
<li>Support for long-running and event-triggered requests</li>
<li>Scalability for dynamic content generation</li>
</ul>
<h2 id="event-driven-web-application-runtime">Event-driven Web
Application Runtime</h2>
<p>This model extends the <a href="#reactor-pattern">reactor pattern</a>
by allowing the event loop to execute arbitrary application code such as
making database queries and generating HTML output.</p>
<h2 id="node.js">Node.js</h2>
<ul>
<li>Asynchronous, event-driven JS runtime</li>
<li>JS is used because it does not have a threading model or standard IO
functionality, as all those are provided exclusively by the runtime</li>
<li>Extensive use of callbacks</li>
<li>Framework <code>express</code> simplifies HTTP server creation</li>
<li>All callbacks executed sequentially</li>
<li><code>events</code> library provides inter-request interaction</li>
<li><code>npm</code> package manager and package registry</li>
</ul>
<h2 id="unification-of-languages">Unification of Languages</h2>
<p>Using the same programming language for client and server has many
advantages, such as easier debugging and less duplication of server and
client code.</p>
<p>A full JS stack has the advantage of not requiring transpilation or
code generation for the client side. Also, developers might already be
familiar with JS because of its prominence for frontend code.</p>
<p>Popular JS stack “MEAN”: MongoDB, Express, AngularJS, Node.js.</p>
<h1 id="component-based-frameworks">Component-based Frameworks</h1>
<p>This focuses on web component for the client side.</p>
<ul>
<li>Components are reusable view elements, which is desirable to avoid
re-implementing features</li>
<li>No standard way for re-using HTML blocks, templating</li>
</ul>
<h2 id="web-components-specification">Web Components Specification</h2>
<ul>
<li>Standardized 2012</li>
</ul>
<p>Building blocks:</p>
<ul>
<li>Custom Elements API: Custom DOM elements
<ul>
<li>associated JS class for behavior</li>
<li>callbacks for insertion, removal etc</li>
</ul></li>
<li>Shadow DOM: Scoped DOM, encapsulating style + markup
<ul>
<li>hides implementation of components</li>
<li>page styles not applied to shadow dom, shadow dom styles not applied
on page level</li>
</ul></li>
<li>HTML Templates: Declare HTML fragments, instantiate at runtime
<ul>
<li><code>&lt;slot&gt;</code> allows injection of instance specific
data</li>
</ul></li>
<li>ES Modules: reuse of JS documents</li>
</ul>
<h2 id="component-based-application-frameworks">Component-based
Application Frameworks</h2>
<p>Those don’t use the standard components directly, but implement
similar concepts.</p>
<ul>
<li>Angular
<ul>
<li>Declarative HTML templates</li>
<li>Typescript for defining components, which references HTML and
CSS</li>
<li></li>
</ul></li>
<li>React
<ul>
<li>JSX templates: functional instead of declarative</li>
<li>components as state machines</li>
<li>no scoped styles</li>
</ul></li>
<li>Vue.js
<ul>
<li>Declarative HTML templates</li>
</ul></li>
</ul>
<p>Standard Components vs Frameworks:</p>
<ul>
<li>Component support is builtin to browsers</li>
<li>Frameworks often more feature-rich</li>
<li>Frameworks provide virtual DOM</li>
<li>Some frameworks allow export to web components</li>
</ul>
<h1 id="progressive-web-applications">Progressive Web Applications</h1>
<p>Principles of PWAs:</p>
<ul>
<li>discoverable: indexable by search engines</li>
<li>installable: integrates with platform
app-launcher/homescreen/whatever</li>
<li>linkable: sharing via URI</li>
<li>network independent: PWA can work offline or with limited
connectivity</li>
<li>progressive: basic feature set for old browser, extended features
for new browsers
<ul>
<li>graceful degradation: mitigation techniques for missing
features</li>
<li>shims, polyfills: re-implementation of modern web APIs for browsers
without native support in plain JS</li>
<li>progressive enhancements: opposite of graceful degradation: upgrade
basic functionality if available</li>
<li>transpilation of modern JS to version compatible with older browser
version</li>
</ul></li>
<li>re-engageable: can send notifications to users</li>
<li>responsive: adapts to device and screen size</li>
<li>safe: secure communication, protection of sensitive data</li>
</ul>
<p>Implementing PWAs:</p>
<ul>
<li>secure contexts
<ul>
<li>browser allows access to sensitive APIs only if requirements
fulfilled</li>
<li>requirements might be e.g. a secure connection</li>
</ul></li>
<li>web app manifests
<ul>
<li>declares information about web app such as
<ul>
<li>homescreen icons</li>
<li>appearance options such as full-screen mode</li>
<li>screen orientation</li>
<li>system colors</li>
</ul></li>
<li>referenced by link from HTML header</li>
</ul></li>
<li>service workers
<ul>
<li>proxy between application and network</li>
<li>implements:
<ul>
<li>offline support</li>
<li>cache control</li>
<li>pre-fetching resources</li>
<li>background tasks such as data sync, push notifications</li>
</ul></li>
<li>fully asynchronous</li>
<li>only available in secure context</li>
</ul></li>
</ul>
<h1 id="popular-implementations">Popular Implementations</h1>
<p>This section has been skipped due to an unbearable amount of Java EE
content.</p>
<h1 id="introduction-to-scalability">Introduction to Scalability</h1>
<h2 id="part-1">Part 1</h2>
<p>The main requirements for a large scale web application are</p>
<ul>
<li>reliability</li>
<li>scalability</li>
<li>maintainability</li>
</ul>
<p>A scalable system is able to cope with varying load. This might
require utilizing additional resources, or graceful degradation in case
of temporary overload. Scalability is not the same as performance, as a
system which has good performance for a single user it might still not
scale well for large numbers of users.</p>
<h3 id="client-side-performance-metrics">Client Side Performance
Metrics</h3>
<ul>
<li>DNS lookup time</li>
<li>Time to first byte TTFB</li>
<li>Time to first contentful paint (FCP)</li>
<li>Time to start render</li>
<li>Time to interactive (TTI)</li>
</ul>
<h3 id="server-side-performance-metrics">Server Side Performance
Metrics</h3>
<ul>
<li>request throughput (requests per second)</li>
<li>response times (time between receiving request and responding)</li>
<li>hardware utilization</li>
<li>availability</li>
<li>uptime</li>
</ul>
<h4 id="response-times">Response Times</h4>
<p>Both average and peak response time can be measured.. However, those
statistics are of limited relevance, since the distribution is usually
not normal or uniform. A better way of assessing response times are
percentiles (99% of all responses arrive within <span
class="math inline">\(p_{99}\)</span>). Percentile plots (hockey stick
plots) allow comparing response times of multiple systems.</p>
<h4 id="throughput-vs-response-time">Throughput vs Response Time</h4>
<p>Under load, increased throughput negatively affects response times.
This might be due to requests being queued for example.</p>
<h2 id="part-2">Part 2</h2>
<h3 id="load-characteristics">Load Characteristics</h3>
<p>Load: externally assigned work for the system</p>
<p>Load is characterized by load parameters:</p>
<ul>
<li>web server load
<ul>
<li>number of requests</li>
<li>type of requests</li>
<li>target URIs</li>
</ul></li>
<li>application backend load
<ul>
<li>application specific, e.g. ratio of read/write DB operations</li>
</ul></li>
</ul>
<p>Roary example load parameters:</p>
<ul>
<li>add-post operations per second</li>
<li>view-post operations per second</li>
<li>ratio between both</li>
</ul>
<p>secondary load parameters in this example might be the number of
followers and subscriptions per user, or the distribution of those among
the user-base.</p>
<h3 id="scalability-strategies">Scalability Strategies</h3>
<ul>
<li>Scale-Up (vertical): Adding more resources to existing machines
<ul>
<li>inherent physical limits</li>
</ul></li>
<li>Scale-Out (horizontal): Adding more machines
<ul>
<li>requires distribution</li>
</ul></li>
</ul>
<h4 id="scale-cube">Scale Cube</h4>
<p>Axes:</p>
<ul>
<li>horizontal duplication
<ul>
<li>cloning services</li>
<li>replicating instances such as DBs</li>
<li>load-balancing between entities</li>
</ul></li>
<li>functional decomposition
<ul>
<li>separation of services</li>
<li>partitioning of data sets</li>
</ul></li>
<li>data partitioning
<ul>
<li>sharding of service instances (dedicated instances for certain
groups of users)</li>
<li>distribute dataset based on key</li>
</ul></li>
</ul>
<p>Example for scaling up users+products database:</p>
<ul>
<li>Replication of entire database allows more concurrent read
operations</li>
<li>Separating users and products tables into two instances increases
capacity for each and allows independent scaling</li>
<li>Splitting entire dataset into two databases by key</li>
</ul>
<p>All three approaches can be combined, even for this simple database
example.</p>
<h4 id="general-strategies">General Strategies</h4>
<ul>
<li>stateless components are easier to scale and replicate</li>
<li>avoid single points of failure</li>
<li>shared state makes replication and sharding difficult</li>
<li>asynchronous services and calls prevent bottlenecks</li>
<li>caching may be used on all architecture layers and can have huge
benefits</li>
<li>monitoring load and performance is crucial</li>
</ul>
<h1 id="interactioncommunication">Interaction/Communication</h1>
<h2 id="http2">HTTP2</h2>
<ul>
<li>Application layer interface untouched</li>
<li>Data layout changed</li>
<li>Improvements:
<ul>
<li>stream multiplexing (parallel HTTP transactions, priorities)</li>
<li>binary encoding, header and data compression</li>
<li>server push</li>
</ul></li>
<li>HTTP3: HTTP over QUIC (UDP) currently draft</li>
</ul>
<h2 id="client-backend-communication">Client-Backend Communication</h2>
<p>Required for:</p>
<ul>
<li>AJAX: load additional information by initiation of client</li>
<li>SPAs:
<ul>
<li>accessing business data</li>
<li>triggering server-side operations</li>
<li>loading code</li>
<li>loading HTML</li>
</ul></li>
</ul>
<h3 id="rest">REST</h3>
<p>“Representational state transfer” is a style and set of guidelines,
which supports large-scale web applications and works well with
HTTP:</p>
<ul>
<li>client-server architecture with request-response communication</li>
<li>statelessness: client manages session state, each request includes
all necessary information (such as pagination cursor versus
server-stored pagination state for session)</li>
<li>cacheability: responses labeled with cacheability</li>
<li>layered system: clients, servers, intermediaries such as caches,
load balancers, etc</li>
<li>uniform interface:
<ul>
<li>small set of generic operations: create, read, update, delete.
Applicable to all resources in system</li>
<li>identification of resources:
<ul>
<li>architecture is “resource oriented”, such as users, products or blog
posts.</li>
<li>Resources are identified by URIs, which are independent from
resource representation</li>
</ul></li>
<li>manipulation of resources via their representations: request
resource (in some representation), modify, send changed resource
back</li>
<li>self-descriptive messages: message contains metadata,
e.g. representation used via content-type header</li>
<li>hypermedia as the engine of application state:
<ul>
<li>application state changes on following links, submitting forms or
following redirections</li>
<li>clients do not need to know internal application layout, base URL
allows exploring the application</li>
<li>might require additional formats for non-HTML data</li>
</ul></li>
</ul></li>
</ul>
<h3 id="graphql">GraphQL</h3>
<p>The goal of GraphQL is to avoid disadvantages of REST, and in
particular make it possible to retrieve only the necessary data, and all
of it in a single operation. An example from Roary would be requesting
some information about a user and their last three posts. This would
require multiple requests when following REST (user, post list,
individual post-details).</p>
<p>In GraphQL, the query specifies the exact fields required, such
as:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode graphql"><code class="sourceCode graphql"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">query</span> {</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    User(id: <span class="dv">34</span>) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>        name</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>        roars(last: <span class="dv">3</span>) {</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>            message</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>This requests only the name of the users, and the text of the last
three roars. Responses are provided in JSON format.</p>
<p>Using GraphQL requires a schema definition for the available
resources, which serves as a template for possible queries. Queries can
also be created to modify data, or subscribe to update-events. The
server has to implement some functions to resolve queries, libraries are
available to connect GraphQL queries to data sources such as
databases.</p>
<p>Client-side frameworks are available which link views with GraphQL
queries.</p>
<p>While GraphQL eliminates REST problems such as transferring
unnecessary data in multiple requests, and allows for fast frontend
iteration without backend modifications, drawbacks exist: Caching is
more complex, since data is often incomplete, and queries can be very
complex. This leads to large processing demands on the server, which
also vary widely by request.</p>
<h3 id="websockets">Websockets</h3>
<p>HTTP is not suited for interactive two-way communication (prime
example: web chat application). An option to solve this would be AJAX
polling, or AJAX long polling, but this requires complex server-side
coordination and bears the hidden cost of HTTP (headers, TLS handshakes,
etc).</p>
<p>The modern approach however is WebSocket: WebSocket describes both an
API and protocol:</p>
<ul>
<li>reliable client-server interaction</li>
<li>compatible with HTTP connections</li>
<li>TLS integrated</li>
<li>callback-based API suited for JS</li>
</ul>
<p>The client opens a WebSocket connection to the server, and can then
send messages and react to incoming messages. The server listens to
incoming requests to open connections, and then interacts with the
connection.</p>
<p>The WebSocket protocol is compatible with HTTP, and uses a GET
request to initiate a connection. After the response, the protocol is
switched to WebSocket. Subsequent messages are not HTTP requests, but
use the WebSocket wire protocol. WebSocket packets have at least two
bytes overhead and allow binary payloads.</p>
<p>Application protocols are usually used on top of WebSocket, which can
already be specified when initiating the connection.</p>
<h2 id="backend-backend-communication">Backend-Backend
Communication</h2>
<p>This type of communication occurs between servers which are part of
the backend. An example might be communication between an application
server and database server.</p>
<p>Previously mentioned protocols like REST and GraphQL might be used
between servers, but there are additional options:</p>
<h3 id="rpc-remote-procedure-call">RPC: Remote Procedure Call</h3>
<ul>
<li>Resembles a function invocation that happens on a remote host</li>
<li>request-reply interaction</li>
<li>Extends REST, which only allows CRUD operations</li>
<li>requires marshaling (serialization) of parameters and result</li>
</ul>
<p>Popular implementations:</p>
<ul>
<li>Java RMI: transparent method invocation between JVMs</li>
<li>gRPC: language agnostic, based on HTTP/2 and protobuf. Also able to
handle streams of data.</li>
<li>SQL: known for DB access, usually embedded into database
connectors</li>
</ul>
<h3 id="web-services-communication">Web Services Communication</h3>
<ul>
<li>no standardized definition</li>
<li>not widely used?</li>
</ul>
<p>SOAP:</p>
<ul>
<li>XML based message protocol</li>
<li>multi paradigm: request-reply, request only, multi-reply, multicast,
etc (“message exchange patterns”)</li>
<li>needs underlying protocol such as HTTP</li>
<li>defines application data encoding based on XML schema</li>
</ul>
<p>WSDL “Web Service Description Language”:</p>
<ul>
<li>XML format for describing web services, basic building blocks:
<ul>
<li>types: specify messages (such as SOAP)</li>
<li>interface: specify functionality</li>
<li>binding: how to access service (protocols)</li>
<li>service: where to access functionality</li>
</ul></li>
<li>can be used for code generation</li>
</ul>
<h2 id="advanced-concepts">Advanced Concepts</h2>
<h3 id="messaging">Messaging</h3>
<ul>
<li>Interconnect servers by message bus</li>
</ul>
<h4 id="queuing">Queuing</h4>
<ul>
<li>messages addressed to queues</li>
<li>queues resemble mailboxes</li>
<li>receiver asynchronously fetches messages from queue</li>
<li>queue decouples sender and receiver</li>
</ul>
<h4 id="pub-sub">Pub-Sub</h4>
<ul>
<li>messages not specifically addressed</li>
<li>receivers subscribe to desired messages</li>
<li>could be topic based or content based</li>
<li>implementation could be one queue per topic</li>
</ul>
<h4 id="implementation-notes">Implementation Notes</h4>
<ul>
<li>library approach: queue is integrated into receiver application</li>
<li>server approach: queue located on dedicated message server
<ul>
<li>replication of server allows scaling</li>
</ul></li>
</ul>
<p>Examples:</p>
<ul>
<li>IBM MQ
<ul>
<li>combines queuing and pubsub</li>
</ul></li>
<li>Apache Kafka
<ul>
<li>persistent message stored</li>
<li>topic-based pubsub</li>
<li>allows stream processing</li>
<li>scalability:
<ul>
<li>partitioning of topic queues</li>
<li>receivers organized in consumer groups, which subscribe to topics.
Consumer group could have one receiver per partition of topic
queue.</li>
</ul></li>
</ul></li>
</ul>
<h3 id="seda-staged-event-driven-architecture">SEDA: Staged Event-Driven
Architecture</h3>
<ul>
<li>motivation: efficient internet services even for load spikes</li>
<li>idea: pipelining</li>
<li>stage input: event queue</li>
<li>stage outputs: events for subsequent stages</li>
</ul>
<p>Advantages:</p>
<ul>
<li>independent processing units</li>
<li>decoupled stages</li>
<li>parallelization of stages</li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>queues can become bottlenecks</li>
<li>complex architecture</li>
<li>nowadays: no performance improvement compared to (modern) threading
systems</li>
</ul>
<h3 id="back-pressure">Back Pressure</h3>
<ul>
<li>concept for preventing exhaustion of service resources</li>
<li>idea: block resource consumption until resources are available</li>
<li>examples:
<ul>
<li>block additional connections</li>
<li>block producers from submitting new messages</li>
<li>block callers from invoking procedures</li>
</ul></li>
<li>might lead to pipeline stalls, but prevents system from crashing
(graceful degradation)</li>
</ul>
<h1 id="state">State</h1>
<h2 id="state-in-scalable-web-architectures">State in Scalable Web
Architectures</h2>
<p>In this section, we consider server-side state. We have to
differentiate the context of the state: request, session, long-term.
Additionally, we have to differentiate between ephemeral/volatile,
derived and persistent state.</p>
<h2 id="caching">Caching</h2>
<p>Main idea: prevent duplicate work.</p>
<p>Challenges:</p>
<ul>
<li>potential for inconsistent state</li>
<li>cache could become bottleneck</li>
<li>failing/restarting caches may overload downstream components</li>
<li>increased system complexity</li>
</ul>
<p>Application of caching throughout the architecture:</p>
<ul>
<li>client side caching of responses</li>
<li>outsourcing to CDNs</li>
<li>reverse proxies with cache: serve static content and cached
dynamically generated pages</li>
<li>cache support on web servers: cache-control headers etc</li>
<li>application servers: caching in language runtimes (bytecode for
interpreted languages), caching of DB queries, application specific
strategies</li>
<li>database: various internal caching methods, caching of query
results</li>
<li>in-memory data stores: provides caching for other components</li>
<li>backend services: caching of results</li>
</ul>
<p>Rule of thumb: cache high up in the call stack (close to the
client).</p>
<h2 id="data-models">Data Models</h2>
<h3 id="relational-model">Relational Model</h3>
<ul>
<li>SQL for data definition, manipulation, querying</li>
<li>transactions</li>
</ul>
<h3 id="keyvalue">Key/Value</h3>
<ul>
<li>hash table storage</li>
<li>limited size key</li>
<li>usually arbitrary value</li>
</ul>
<h3 id="document-oriented">Document oriented</h3>
<ul>
<li>similar to k/v, but structured document as value</li>
<li>document usually JSON, XML, etc</li>
</ul>
<h3 id="graph-model">Graph Model</h3>
<ul>
<li>data items as vertices and edges</li>
<li>interesting if querying relationships between items is common
operation (social network, road network)</li>
</ul>
<h3 id="column-oriented-model">Column-oriented Model</h3>
<ul>
<li>storage of tables by column instead of rows</li>
<li>more complex insert operation</li>
<li>efficient operations over large table, such as aggregation</li>
</ul>
<h2 id="functional-decomposition">Functional Decomposition</h2>
<p>Idea: Split application model into logical parts which can be
separated.</p>
<ul>
<li>allows physical separation</li>
<li>enables use of different data models</li>
<li>join-logic must be handled by application</li>
</ul>
<h2 id="replication">Replication</h2>
<p>Idea: Multiple copies of the same data.</p>
<ul>
<li>increases throughput</li>
<li>increases availability (tolerate failure of a replica)</li>
<li>reduces latency via geo-replication</li>
</ul>
<p>Primary challenge: mutable data. This requires propagation of updates
to achieve consistency between replicas.</p>
<h3 id="leader-follower-replication">Leader-Follower Replication</h3>
<ul>
<li>Dedicated leader database and set of replicas, called followers</li>
<li>Only read-only applications sent to follower databases</li>
<li>writes replicated from leader to follower</li>
<li>replication might be done synchronously (within the write operation)
or asynchronously</li>
</ul>
<p>Replication Mechanism:</p>
<ul>
<li>statement based: direct execution of statements in replicas.
statements must be deterministic.</li>
<li>log based: append-only log of changes sent to replicas. might be
“write-ahead log” of more low-level write operations</li>
<li>application triggered: replication triggered and specified by user
application</li>
</ul>
<p>Properties/guarantees relating to consistency anomalies:</p>
<ul>
<li>read your own writes: guarantee of seeing previous write in
subsequent read</li>
<li>monotonic reads: guarantee that subsequent reads will never return a
previous version of the state</li>
<li>consistent prefix reads: data items observed in causally correct
order</li>
</ul>
<h3 id="multi-leader-replication">Multi-Leader Replication</h3>
<ul>
<li>Multiple instances handle write operations</li>
<li>might be generalized to client-server interaction (e.g. for
PWAs)</li>
</ul>
<p>Main problem: write conflicts. Strategies for resolution:</p>
<ul>
<li>conflict avoidance: each data item has one authoritative leader
which handles write operations</li>
<li>convergence to consistent state: ensure all leaders agree after
replication, such as by enforcing global order on update operations</li>
<li>user-defined resolution: application specific</li>
</ul>
<h3 id="leaderless-replication">Leaderless Replication</h3>
<ul>
<li>always contact all instances, but only require certain number of
responses (quorum)</li>
<li>write quorum <span class="math inline">\(w &lt; n\)</span> for <span
class="math inline">\(n\)</span> replicas: writes possible even if
replica is down</li>
<li>sum of write and read quorum <span
class="math inline">\(w+r&gt;n\)</span>, such as <span
class="math inline">\(w=r=\frac{n}{2}+1\)</span></li>
<li>optimization: smaller <span class="math inline">\(r\)</span> for
read-heavy loads</li>
<li>if <span class="math inline">\(w+r \leq n\)</span>: increased risk
of reading stale data</li>
</ul>
<h2 id="shardingpartitioning">Sharding/Partitioning</h2>
<ul>
<li>Split a collection of data item into multiple partitions</li>
<li>requires routing of requests to correct partition</li>
<li>primary challenge: partitioning scheme which creates even
distribution and allows rebalancing</li>
</ul>
<p>Partitioning schemes:</p>
<ul>
<li>key range: shard = ranged partition of key space
<ul>
<li>straightforward</li>
<li>prone to skewed workloads</li>
</ul></li>
<li>hashed keys
<ul>
<li>no inherent support of range queries</li>
</ul></li>
</ul>
<p>Rebalancing shards: scale-out by adding instances, ideally with low
migration effort</p>
<ul>
<li>dynamic partitioning (key based sharding): split keyspace of
overloaded shard in two halves, assign one half to new shard</li>
<li>fixed number of shards which is way larger than number of machines:
new machine can take some existing shards</li>
<li>fixed number of shards per machine: new machine picks some shards,
splits them and hosts one half</li>
</ul>
<p>Sharding is often combined with replication.</p>
<h2 id="data-consistency">Data Consistency</h2>
<p>Consistency models define visibility semantics and system
behavior.</p>
<h3 id="cap-theorem">CAP Theorem</h3>
<p>In case of a partition, a system can either</p>
<ul>
<li>focus on consistency, but loose availability, or:</li>
<li>keep instance available, but not guarantee consistency</li>
</ul>
<h3 id="pacelc-theorem">PACELC Theorem</h3>
<ul>
<li>In case of a network partition, you have to choose between
availability and consistency.</li>
<li>Else, in normal operation, you have to choose between latency and
consistency.</li>
</ul>
<h3 id="harvestyield">Harvest/Yield</h3>
<ul>
<li>harvest: completeness of queries</li>
<li>yield: probability of completing a request</li>
<li>in some cases, an incomplete result is better than no result</li>
</ul>
<h2 id="event-sourcing">Event Sourcing</h2>
<ul>
<li>alternative style for persisting data</li>
<li>append-only sequence of (immutable) state-changes</li>
<li>state computed by applying all state-changes in order</li>
<li>event log is persisted, for example on append-only k/v store</li>
</ul>
<p>Benefits:</p>
<ul>
<li>Persistence of state history</li>
<li>explicit consistency model</li>
</ul>
<p>Drawbacks:</p>
<ul>
<li>unconventional</li>
<li>increased storage requirements</li>
</ul>
<h1 id="logic">Logic</h1>
<h2 id="application-logic">Application Logic</h2>
<ul>
<li>logic required for generating dynamic web pages or providing
application services and functions</li>
<li>external and internal endpoints</li>
<li>sequential execution of application logic
<ul>
<li>application server sequentially calls and waits for results from DBs
and backend services</li>
<li>does not scale for large number of backend services</li>
</ul></li>
<li>event-driven and asynchronous execution
<ul>
<li>first, dispatch all calls</li>
<li>second, wait for all results</li>
<li>this might require additional coordination or dependency
management</li>
</ul></li>
</ul>
<h2 id="stateless-and-stateful-application-logic">Stateless and Stateful
Application Logic</h2>
<ul>
<li>stateless: independent request-response cycles, desireable for
scalability</li>
<li>specific meaning of state:
<ul>
<li>session state</li>
<li>server-side application state (“stateful resources”)</li>
</ul></li>
</ul>
<p>Examples: * Video transcoding service: * stateless service: each
individual request contains all required information * easy scalability:
replication * Game: * stateful application logic (game state) maintained
by server * scalability strategy: sharding of game instances without
shared state * Calendar: * stateless application logic, stateless
request handling: state is queried from DB for every request, no
dependency between requests * database maintains stateful resources:
mutable data * scalability: replication of application servers, scaling
of DB (see above)</p>
<p>Stateless logic is prefered whenever possible. It might be possible
to decompose application logic into stateless and stateful parts.</p>
<h2 id="distributing-application-logic">Distributing Application
Logic</h2>
<h3 id="functional-partitioning">Functional Partitioning</h3>
<ul>
<li>Application specific characteristics</li>
<li>Decouple application functions</li>
<li>Application functions might still access the same backend</li>
<li>Allows independent scaling of endpoints</li>
</ul>
<h3 id="horizontal-duplication-replication">Horizontal Duplication
(Replication)</h3>
<ul>
<li>Multiple application servers run same copy of application logic</li>
<li>often requires stateless request handling</li>
<li>arbitrary load balancing strategy</li>
</ul>
<h3 id="data-partitioning-sharding">Data Partitioning (Sharding)</h3>
<ul>
<li>Designate instance to handle designated set of requests</li>
<li>Partitioning based on e.g. user id, session id, client ip, etc</li>
<li>allows stateful request handling logic</li>
<li>load balancing needs to be aware of sharding</li>
</ul>
<h3 id="shared-and-global-state">Shared and Global State</h3>
<ul>
<li>state often handled by database system</li>
<li>transactional semantics challending for distributed databases</li>
<li>querying state from DB might not be fast enough</li>
</ul>
<p>Alternatives:</p>
<ul>
<li>state bound to individual shard: concurrency only within single
application server</li>
<li>distributed state between application instances: requires distriuted
concurrency mechanism
<ul>
<li>actor model</li>
<li>event-driven model (shared event bus, pubsub)</li>
<li>distributed transactions</li>
</ul></li>
</ul>
<h2 id="background-tasks">Background Tasks</h2>
<ul>
<li>request independent application logic
<ul>
<li>maintanance tasks</li>
<li>data analysis tasks</li>
</ul></li>
<li>might be long running compared to requests</li>
<li>often requires access to backend and application state</li>
</ul>
<h3 id="batch-processing">Batch Processing</h3>
<ul>
<li>long running task</li>
<li>fully available and bounded input data</li>
</ul>
<h3 id="stream-processing">Stream Processing</h3>
<ul>
<li>continuous processing task</li>
<li>input data unbounded and not available in advance</li>
<li>results might be incomplete or approximate</li>
<li>example: trending topic analysis on social networks</li>
</ul>
<h2 id="event-sourcing-and-cqrs">Event Sourcing and CQRS</h2>
<ul>
<li>CQRS: Command Query Responsibility Segregation</li>
<li>idea: differentiate commands (no return value, might have side
effects) and queries (returns data, no side effects)</li>
<li>application to event based programming:
<ul>
<li>command model: state-changing operations, write only</li>
<li>query model: read only query operations</li>
<li>separation of models allows independent development and scaling
strategies</li>
</ul></li>
<li>application to event sourcing:
<ul>
<li>command model creates events</li>
<li>query model interacts with materialized state representation</li>
<li>explicit eventual consistency</li>
<li>easy scaling of query model, loose coupling of components</li>
</ul></li>
</ul>
<h1 id="deploymentinfrastructure">Deployment/Infrastructure</h1>
<h2 id="backend-endpoints">Backend Endpoints</h2>
<h3 id="proxies">Proxies</h3>
<ul>
<li>endpoint for HTTP requests</li>
<li>main task: forwarding to server, usually also caching</li>
<li>location: near the client</li>
<li>purpose:
<ul>
<li>scalability</li>
<li>filtering</li>
<li>source obfuscation</li>
</ul></li>
</ul>
<h4 id="reverse-proxies">Reverse Proxies:</h4>
<ul>
<li>location: near the server</li>
<li>purpose:
<ul>
<li>hides backend structure</li>
<li>filtering, caching, compression</li>
<li>security: TLS endpoint, maybe even authentication</li>
<li>load balancing</li>
<li>logging</li>
</ul></li>
</ul>
<p>Popular software:</p>
<ul>
<li>apache</li>
<li>nginx</li>
<li>HAProxy</li>
</ul>
<h3 id="load-balancing">Load Balancing</h3>
<ul>
<li>goal: scalabiltiy</li>
<li>distribute incoming requests among multiple servers</li>
</ul>
<p>Two design dimensions:</p>
<ul>
<li>Request routing
<ul>
<li>naming: Resolve same DNS name to multiple IP addresses, usually in a
round-robin strategy. This resolves the DNS resolution equally, but this
might not balance the load equally. It would also be feasable here to
distribute based on source IP.</li>
<li>Application: A reverse proxy distributes HTTP requests. Here, a load
based distribution strategy might be possible, if the proxy has access
to load parameters of servers. Session stickiness ensures that all the
requests of a single session reach the same backend server. This
simplifies session state handling.</li>
<li>Transport: Reverse proxy distributes TCP connections. This has the
advantage of being protocol agnostic.</li>
</ul></li>
<li>distribution strategies
<ul>
<li>round robin</li>
<li>load based</li>
<li>session based</li>
<li>source based</li>
</ul></li>
</ul>
<h3 id="cdns">CDNs</h3>
<ul>
<li>3rd party provider</li>
<li>CDN handles (global) replication</li>
<li>client direclty routed to CDN servers</li>
</ul>
<h2 id="cloud-computing">Cloud Computing</h2>
<p>Model for enabling on demand access to shared pool of computing
resources, which can be rapidly provisioned with minimal effort and
interaction.</p>
<p>Characteristics of cloud services:</p>
<ul>
<li>on-demand self service</li>
<li>network access via standard interfaces</li>
<li>resource pooling (multiplexing, virtualization)</li>
<li>elasticity: fast adaptation and scaling</li>
<li>measured service: pay as you go</li>
</ul>
<p>Deployment Models:</p>
<ul>
<li>private cloud</li>
<li>comunity cloud</li>
<li>public cloud</li>
<li>(hybrid models)</li>
</ul>
<h3 id="service-models">Service Models</h3>
<h4 id="infrastructure-as-a-service-iaas">Infrastructure as a Service
IaaS</h4>
<ul>
<li>computing instance
<ul>
<li>physical or virtual (typically VM)</li>
<li>initialized using image</li>
</ul></li>
<li>network
<ul>
<li>bridges/routers</li>
</ul></li>
<li>storage</li>
<li>containers</li>
</ul>
<p>(Part 2 25:00)</p>
<h4 id="platform-as-a-service-paas">Platform as a Service PaaS</h4>
<p>Application runtime such as FCGI runtime env or servlet container</p>
<h4 id="software-as-a-service-saas">Software as a Service SaaS</h4>
<p>Applications</p>
<h3 id="virtualization">Virtualization</h3>
<h2 id="advanced-topics">Advanced Topics</h2>
<h1 id="security-and-privacy">Security and Privacy</h1>
<h1 id="devops">DevOps</h1>
</body>
</html>
