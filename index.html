<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Jonas Otto" />
  <meta name="dcterms.date" content="2023-01-01" />
  <title>Architectures for Distributed Internet Services</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
  </style>
  <link rel="stylesheet" href="styling.css" />
</head>
<body>
<header id="title-block-header">
<h1 class="title">Architectures for Distributed Internet Services</h1>
<p class="author">Jonas Otto</p>
<p class="date">2023</p>
</header>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#architectures-for-distributed-internet-services">Architectures for Distributed Internet Services</a></li>
<li><a href="#static-web-content">Static Web Content</a>
<ul>
<li><a href="#web-servers">Web Servers</a>
<ul>
<li><a href="#static-content">Static Content</a></li>
<li><a href="#architectures">Architectures</a></li>
</ul></li>
</ul></li>
<li><a href="#dynamic-web-content">Dynamic Web Content</a>
<ul>
<li><a href="#client-side-dynamicity">Client-side dynamicity</a></li>
<li><a href="#server-side-dynamicity">Server-side dynamicity</a></li>
<li><a href="#creating-dynamic-web-content">Creating dynamic web content</a>
<ul>
<li><a href="#server-side-includes">Server Side Includes</a></li>
<li><a href="#external-programs-cgi">External Programs: CGI</a></li>
<li><a href="#alternative-fastcgi">Alternative: FastCGI</a></li>
<li><a href="#scgi-simple-common-gateway-interface-alternative-to-fastcgi">SCGI (Simple Common Gateway Interface): Alternative to FastCGI</a></li>
<li><a href="#problems-with-cgi">Problems with CGI</a></li>
</ul></li>
</ul></li>
<li><a href="#server-side-scripting">Server-side Scripting</a>
<ul>
<li><a href="#example-perl">Example: Perl</a></li>
<li><a href="#example-java">Example: Java</a></li>
<li><a href="#example-php">Example: PHP</a></li>
</ul></li>
<li><a href="#data-management-sever-side-state">Data Management: Sever-Side State</a>
<ul>
<li><a href="#storage-options">Storage Options</a>
<ul>
<li><a href="#main-memory">main memory</a></li>
<li><a href="#local-storage">local storage</a></li>
<li><a href="#remote-storage">remote storage</a></li>
</ul></li>
</ul></li>
<li><a href="#session-management">Session Management</a>
<ul>
<li><a href="#url-session-identifiers">URL Session Identifiers</a></li>
<li><a href="#cookies">Cookies</a></li>
<li><a href="#session-state">Session State</a></li>
<li><a href="#securtity">Securtity</a></li>
</ul></li>
<li><a href="#client-side-developments">Client-side Developments</a></li>
<li><a href="#object-relational-mapping">Object-relational Mapping</a></li>
<li><a href="#structured-developments">Structured Developments</a></li>
<li><a href="#ria-and-spa">RIA and SPA</a></li>
<li><a href="#node.js-and-unification-of-languages">Node.js and Unification of Languages</a></li>
<li><a href="#component-based-frameworks">Component-based Frameworks</a></li>
<li><a href="#progressive-web-applications">Progressive Web Applications</a></li>
<li><a href="#popular-implementations">Popular Implementations</a></li>
<li><a href="#introduction-to-scalability">Introduction to Scalability</a></li>
<li><a href="#interactioncommunication">Interaction/Communication</a></li>
<li><a href="#state">State</a></li>
<li><a href="#logic">Logic</a></li>
<li><a href="#deploymentinfrastructure">Deployment/Infrastructure</a></li>
<li><a href="#security-and-privacy">Security and Privacy</a></li>
<li><a href="#devops">DevOps</a></li>
</ul>
</nav>
<h1 id="architectures-for-distributed-internet-services">Architectures for Distributed Internet Services</h1>
<p>This is my summary for the lecture “Architectures for Distributed Internet Services”, as held by Franz Hauck and Benjamin Erb in 2022 at Ulm University.</p>
<p>The HTML version of this summary can be found at <a href="https://ottojo.github.io/ADIS_Summary/">https://ottojo.github.io/ADIS_Summary/</a>, the sources are on GitHub at <a href="https://github.com/ottojo/ADIS_Summary">https://github.com/ottojo/ADIS_Summary</a>.</p>
<h1 id="static-web-content">Static Web Content</h1>
<h2 id="web-servers">Web Servers</h2>
<ul>
<li>HTTP endpoint which exposes HTTP endpoints</li>
<li>Typical tasks:
<ul>
<li>Request parsing</li>
<li>URI resolving</li>
<li>Responding with appropriate content</li>
</ul></li>
<li>Content often provided by external components</li>
<li>Offers SSL/TLS termination</li>
<li>Might provide access control</li>
<li>Might provide caching</li>
</ul>
<h3 id="static-content">Static Content</h3>
<ul>
<li>This represents a large amount of web resources</li>
<li>Examples:
<ul>
<li>Immutable content (images, videos, static pages)</li>
<li>Static assets (stylesheets, JS sources)</li>
</ul></li>
<li>Server performance in this case predominantly I/O-bound (both disk and network)</li>
</ul>
<h3 id="architectures">Architectures</h3>
<h4 id="multi-thread-multi-process">multi-thread / multi-process</h4>
<ul>
<li>One dedicated thread for accepting connections</li>
<li>Dedicated thread per connections (spawned by first thread)</li>
<li>Allows multiple concurrent connections</li>
<li>Synchronous, blocking IO may be used</li>
<li>Large number of connections make efficient scheduling challenging</li>
<li>-&gt; C10k Problem: Challenge of handling 10k concurrent connections to a server (early 2000s, now: C1M scale and beyond)</li>
</ul>
<h4 id="solutions-for-the-c10k-problem">Solutions for the C10k Problem</h4>
<ul>
<li>Avoid spawning many processes</li>
<li>Avoid 1:1 mapping between connections and threads</li>
<li>Using asynchronous and non-blocking I/O (reduces number of waiting threads)</li>
</ul>
<h4 id="reactor-pattern">Reactor Pattern</h4>
<ul>
<li>Reactor: single thread with event-loop
<ul>
<li>reacts to IO events from a queue</li>
<li>dispatches events</li>
</ul></li>
<li>Event-specific handlers
<ul>
<li>process events produced by reactor</li>
</ul></li>
<li>Implemented in nginx: One master process + one worker per core</li>
</ul>
<h1 id="dynamic-web-content">Dynamic Web Content</h1>
<h2 id="client-side-dynamicity">Client-side dynamicity</h2>
<ul>
<li>Generated within browser</li>
<li>Related to presentation of content</li>
</ul>
<h2 id="server-side-dynamicity">Server-side dynamicity</h2>
<ul>
<li>automatic updating of static files</li>
<li>webserver delegates requests to external programs
<ul>
<li>e.g. CGI script</li>
</ul></li>
<li>webserver executes scripts internally
<ul>
<li>e.g. php module</li>
</ul></li>
<li>webserver has builtin site-gerneration code
<ul>
<li>tight coupling between webserver and application</li>
</ul></li>
</ul>
<h2 id="creating-dynamic-web-content">Creating dynamic web content</h2>
<ul>
<li>some program takes http requests as input and produces web resources (HTML) as output
<ul>
<li>e.g. java servelet</li>
</ul></li>
<li>code may be embedded into web resource, inserting code output into resource
<ul>
<li>e.g. java server faces, PHP</li>
</ul></li>
</ul>
<h3 id="server-side-includes">Server Side Includes</h3>
<ul>
<li>Directives inserted into HTML</li>
<li>executed by the server, but may delegate to CGI scripts</li>
</ul>
<h3 id="external-programs-cgi">External Programs: CGI</h3>
<ul>
<li>Specifies interaction between webserver and external programs (CGI scripts)</li>
<li>Server spawns new process for each request</li>
<li>HTTP headers passed via env variables</li>
<li>HTTP body passed via stdin</li>
<li>CGI script may produce entire HTTP response, or only essential headers and body (remaining data added by server)</li>
<li>Modules for interacting with CGI webserver exist in programming languages, such as CGI.pm in perl</li>
</ul>
<p>Drawbacks:</p>
<ul>
<li>Process creation may be slow</li>
<li>Script initialization happens on every request</li>
<li>Limited communication channel in stdin/out</li>
</ul>
<h3 id="alternative-fastcgi">Alternative: FastCGI</h3>
<ul>
<li>Binary protocol</li>
<li>via unix socket/named pipe/tcp connection</li>
<li>Script keeps running and processes multiple request</li>
<li>Multiple (remote) FastCGI applications may be running and accessed by single web server
<ul>
<li>allows load balancing</li>
<li>separates web and application server</li>
</ul></li>
</ul>
<h3 id="scgi-simple-common-gateway-interface-alternative-to-fastcgi">SCGI (Simple Common Gateway Interface): Alternative to FastCGI</h3>
<ul>
<li>Simplifies interface: non-binary interface</li>
<li>Easier to implement than FastCGI</li>
</ul>
<h3 id="problems-with-cgi">Problems with CGI</h3>
<ul>
<li>CGI programs often use same security context as web server</li>
<li>Apache allows running CGI scripts as specified user/group</li>
</ul>
<h1 id="server-side-scripting">Server-side Scripting</h1>
<p>Scenario: Static HTML page should be enriched by dynamic content.</p>
<p>Here, inside-out scripting is considered. This means scripts are placed inside HTML document. The script output is inserted at their location in the HTML document.</p>
<p>Execution of the scripts:</p>
<ul>
<li>External script interpreter, spawned by server</li>
<li>Long-ruinning external execution environment
<ul>
<li>Similar benefits to FastCGI vs CGI</li>
<li>Used by PHP for example</li>
</ul></li>
<li>Server-internal script handling</li>
</ul>
<p>Inside-out scripting allows HTML-centric development approach.</p>
<p>Self-processing pages are a pattern for processing form data on the same page it is displayed on. This is done by distinguishing between GET/POST request during script execution.</p>
<h2 id="example-perl">Example: Perl</h2>
<ul>
<li>Approach 1
<ul>
<li>HTML provided in template file with placeholders</li>
<li>Separate script provides content for placeholders</li>
</ul></li>
<li>Approach 2
<ul>
<li>Code directly embedded in HTML with special syntax</li>
<li>Output is inserted in location of script, if requested</li>
</ul></li>
</ul>
<h2 id="example-java">Example: Java</h2>
<ul>
<li>Inside-out scripting approach</li>
<li>Before execution, JSP-to-Java transformation transforms HTML with embedded scripts to Java program (“Servlet”) which outputs entire page, containing static and dynamic content.</li>
<li>Generated Servlet allows ahead-of-time compilation</li>
</ul>
<h2 id="example-php">Example: PHP</h2>
<ul>
<li>Designed for inside-out scripting</li>
<li>Execution environment included in web servers like apache</li>
<li>Includes useful functionality for web-dev (databases, HTTP, etc)</li>
</ul>
<h1 id="data-management-sever-side-state">Data Management: Sever-Side State</h1>
<p>Data is stored both on server and client, and data is exchanged in requests and responses. Examples for client data include:</p>
<ul>
<li>Cached resources</li>
<li>Cookies</li>
<li>JS engine state</li>
</ul>
<p>Server data includes:</p>
<ul>
<li>Application data</li>
<li>Session state</li>
<li>Application state</li>
</ul>
<p>The server holds <em>static</em> resources and <em>dynamic</em> application state. Application state may include:</p>
<ul>
<li>User accounts and preferences</li>
<li>Dynamically generated content
<ul>
<li>recommendations</li>
<li>shopping cart</li>
<li>messages between users</li>
</ul></li>
<li>Cached and aggregated data</li>
</ul>
<p>Aspects of server-side state include:</p>
<ul>
<li>how to interact with the server state</li>
<li>how data is modeled</li>
<li>mutability of data</li>
<li>security</li>
<li>storage duration</li>
<li>access patterns</li>
</ul>
<p>Resulting from those aspects are design choices regarding server-side state:</p>
<h2 id="storage-options">Storage Options</h2>
<p>Options are:</p>
<h3 id="main-memory">main memory</h3>
<ul>
<li>application state
<ul>
<li>program memory (stack + heap)</li>
<li>usually managed by language runtime</li>
</ul></li>
<li>in-memory databases
<ul>
<li>provide access API</li>
<li>may provide guarantees about integrity, consistency, visibility</li>
<li>examples: sqlite (in-memory version), h2, many more</li>
</ul></li>
<li>both easy to use and fast access time</li>
<li>drawbacks:
<ul>
<li>volatility (data loss on process stop/restart, overhead otherwise)</li>
<li>small size</li>
</ul></li>
<li>popular for short lived data with fast access requirements</li>
</ul>
<h3 id="local-storage">local storage</h3>
<ul>
<li>file system (flat files)
<ul>
<li>advantages:
<ul>
<li>easy to use</li>
<li>well supported</li>
<li>persistent</li>
<li>easy to backup</li>
<li>large size</li>
</ul></li>
<li>disadvantages
<ul>
<li>unindexed</li>
<li>unstructures</li>
<li>no guarantees for concurrent writes etc</li>
</ul></li>
<li>popular for simple applications</li>
</ul></li>
<li>databases
<ul>
<li>advantages:
<ul>
<li>data is structured</li>
<li>indexed</li>
<li>allow complex search operations</li>
<li>allow relational data</li>
<li>large size</li>
<li>transaction support -&gt; consistency</li>
<li>usually allow distributed setups</li>
<li>integration with other services through standard interfaces (SQL)</li>
</ul></li>
<li>drawbacks:
<ul>
<li>complex API</li>
<li>complex management and administration</li>
</ul></li>
<li>popular for complex structured application data
<ul>
<li>relational databases like postgresql, sqlite, mariadb</li>
<li>noSQL databases, such as k/v stores, document or graph databases</li>
</ul></li>
</ul></li>
</ul>
<h3 id="remote-storage">remote storage</h3>
<ul>
<li>information systems like CRMs</li>
<li>external web services (database server, remote FS)</li>
</ul>
<h1 id="session-management">Session Management</h1>
<p>Sessions provide state beyond individual HTTP requests. Example uses are multi-step forms, login status or shopping carts.</p>
<p>This requires the server to identify subsequent requests belonging to the same user/session. A session is the list of consecutive actions of an individual user. This is usually implemented by labeling the requests, that label is called <em>Session ID</em> or <em>Session Token</em>. The ID is generated on the server side, and has to be unique and un-guessable (to prevent session hijacking). It is transmitted to the client in the first response, which then includes it in subsequent requests. This allows the server to relate it to the session.</p>
<p>Sessions may end, either explicitly (discarding the session ID on server or client) or by timeout.</p>
<h2 id="url-session-identifiers">URL Session Identifiers</h2>
<p>Also called <em>URL rewriting</em>, this is a technique for handling session IDs. It works by embedding the ID in the URL, which requires the server to rewrite all hyperlinks in the response to include the ID.</p>
<p>Advantages:</p>
<ul>
<li>No client support needed</li>
<li>No additional headers required</li>
<li>No cookies required</li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>Security risk: Session ID easily exposed by sharing or logging an URL</li>
<li>Correct rewriting might be difficult</li>
</ul>
<h2 id="cookies">Cookies</h2>
<p>Cookies are small chunks of data (KV pairs) related to one domain, which the client includes for every request to the same domain. Cookies provide a more secure way to attach IDs to session.</p>
<p>The server provides the cookies using <code>Set-Cookie</code> headers, which include the session ID.</p>
<p>The client receives the cookie, saves it and sends it back to the server in subsequent requests using the <code>Cookie</code> header.</p>
<h2 id="session-state">Session State</h2>
<p>Once the server has the possibility to relate requests to sessions, session state can be stored. This session state can be arbitrary, and would usually stored in a database indexed by the session ID.</p>
<p>In principle, the entire state could be stored in a cookie, which eliminates the need for server-side storage but has several drawbacks such as limited size and the possibility for the client to modify the state in unexpected ways.</p>
<h2 id="securtity">Securtity</h2>
<p>There are multiple security considerations regarding sessions, in particular Leaking the ID, which can lead to session hijacking and thus impersonating the user</p>
<h1 id="client-side-developments">Client-side Developments</h1>
<h1 id="object-relational-mapping">Object-relational Mapping</h1>
<h1 id="structured-developments">Structured Developments</h1>
<h1 id="ria-and-spa">RIA and SPA</h1>
<h1 id="node.js-and-unification-of-languages">Node.js and Unification of Languages</h1>
<h1 id="component-based-frameworks">Component-based Frameworks</h1>
<h1 id="progressive-web-applications">Progressive Web Applications</h1>
<h1 id="popular-implementations">Popular Implementations</h1>
<h1 id="introduction-to-scalability">Introduction to Scalability</h1>
<h1 id="interactioncommunication">Interaction/Communication</h1>
<h1 id="state">State</h1>
<h1 id="logic">Logic</h1>
<h1 id="deploymentinfrastructure">Deployment/Infrastructure</h1>
<h1 id="security-and-privacy">Security and Privacy</h1>
<h1 id="devops">DevOps</h1>
</body>
</html>
